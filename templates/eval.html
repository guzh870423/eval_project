<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Evaluation Detail</title>  
  <link rel="stylesheet" href="{{ url_for('static', filename='css/form.css') }}">
  <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel='stylesheet' type='text/css'>
  <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js' type='text/javascript'></script>
 <script src='//cdn.jsdelivr.net/jquery.validation/1.14.0/jquery.validate.js' type='text/javascript'></script>
 <script src='//cdn.jsdelivr.net/jquery.validation/1.14.0/jquery.validate.min.js' type='text/javascript'></script>
  <script src='//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.0/js/bootstrap.min.js' type='text/javascript'></script>
  <script src='//cdnjs.cloudflare.com/ajax/libs/bootstrap-switch/1.8/js/bootstrap-switch.min.js' type='text/javascript'></script>
  <script src='http://davidstutz.github.io/bootstrap-multiselect/js/bootstrap-multiselect.js' type='text/javascript'></script>
</head>
<body>
	<div class="form-header">Evaluation for week {{form.evaluations[0]['week'].data}}</div>
    <div class='container'>
    <a class = 'logout-link' href='{{url_for('logout')}}'>Logout</a>
    </div>
	<form id="eval-form" class='form-horizontal' role='form' method='post' action=''>
    {{ form.hidden_tag() }}
	{% for eval in form.evaluations %}
	<div style='display:none;'>{{eval['evaler_id']}},{{eval['evalee_id']}},{{eval['week']}}</div>
	<div class='container'>
    <div class='panel panel-primary dialog-panel'>
      <div class='panel-heading'>
        <h4>{{eval['evalee_id'].data}}</h4>
      </div>
      <div class='panel-body'>
          <div class='form-group'>
		    {{eval['rank'].label(class='control-label col-md-2 col-md-offset-2')}}
            <div class='col-md-8'>
              <div class='col-md-3'>
                <div class='form-group internal'>
				{{eval['rank'](class='form-control col-md-8',  placeholder='Rank')}}
                </div>
                <div class='validation-error-message'>{{eval['rank'].errors[0] }}</div>
              </div>              
            </div>
			</div>
			<div class='form-group'>
			{{eval['tokens'].label(class='control-label col-md-2 col-md-offset-2')}}
			<div class='col-md-8'>
              <div class='col-md-3'>
                <div class='form-group internal'>
				{{eval['tokens'](class='form-control col-md-8',  placeholder='Tokens', onfocus='showTokenSum()', onblur='hideTokenSum()')}}                  
                </div>	
                <div class='validation-error-message'>{{eval['tokens'].errors[0] }}</div>    
              </div>  
			  <label class='form-message' id='remaining-tokens'/>			  
            </div>
			</div>
			<div class='form-group'>
			{{eval['adjective'].label(class='control-label col-md-2 col-md-offset-2')}}
            <div class='col-md-8'>             
                <div class='col-md-3'>
				  <div class='form-group internal'>
				    {{eval['adjective'](class='form-control', placeholder='Adjective')}}  
				  </div>
                  <div class='validation-error-message'>{{eval['adjective'].errors[0] }}</div>
                </div>
            </div>
          </div>
          <div class='form-group'>
            {{eval['description'].label(class='control-label col-md-2 col-md-offset-2')}}
            <div class='col-md-6'>
			{{eval['description'](class='form-control col-md-8', placeholder='Additional comments')}} 
            </div>
            <div class='validation-error-message'>{{eval['description'].errors[0]}}</div>
          </div>                  
      </div>	  
    </div>	 
    </div>
    {% endfor %}
    <div>
      <div class='center-button'>
	   <button class='btn-lg btn-primary' type='submit'>Submit Evaluation</button>
	  </div>	
    </div>
 </form>
</body>

<script type="text/javascript">
var tokenCount=100;
var tokensEntered=0;

function showTokenSum(){
var countCheck = $("[id*='tokens']");
var sum=0;

for(var i =0; i< countCheck.length;i++)
	{
    temp=parseInt(countCheck[i].value);
    if (isNaN(temp)) temp = 0;
	sum+=temp;
	}
	tokensEntered=sum;
	$('.form-message').text(tokenCount-tokensEntered + ' tokens remaning.');	
}

function hideTokenSum(){
	$('.form-message').text('');	
}
</script>
</html>