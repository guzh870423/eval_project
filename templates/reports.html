<html>
  <head>
    <style type="text/css">
        h2 {page-break-before: always}
    </style>
  </head>
  <body>
    <h2>Reports for semester {{semester.year}} {{ semester.season }} {{ semester.course_no }}, week {{currentWeek}}</h2>
    <p id="demo"></p>

    <script>
        document.getElementById("demo").innerHTML = Date();
    </script>

    <h2>Average ranks </h2>
    <table border="1 px solid black">
        <caption>
            normalized rank =  rank / number of reviews given by evaler. Range: (0,1]<br>
            normalized token = token * number of reviews given by evaler.
        </caption>
        <tr>
            <th>student</th>
            <th>NO. of reveiws</th>
            <th>unweigh. avg. rank</th>
            <th>weigh. avg. rank</th>
            <th>norm. avg. token</th>
        </tr>
        {% for student in students %}
            {% if student.is_active %}
                <tr>
                    <td>{{ names[student.user_name] }}</td>
                    <td>{{len(reversedEvals[currentWeek-1][student.user_name])}}</td>
                    <td>{{averageRank[currentWeek-1][student.user_name]}}</td>
                    <td>{{weightedRank[student.user_name]}}</td>
                    <td>{{averageToken[currentWeek-1][student.user_name]}}</td>
                </tr>
            {% endif %}
        {% endfor %}
    </table>
    {% for student in students %}
        <br>
        <h2>Evalee: {{ names[student.user_name] }}</h2>
        <table border="1 px solid black">
            
            <tr>
                <th>Evaler</th>
                <th>team week</th>
                <th>No. rev.</th>
                <th>Nm. rk</th>
                <th>Nm. tkn</th>
                <th>Adjective</th>
                <th>Description</th>
            </tr>
            {% for evaler in sortedEvaler[currentWeek-1][student.user_name] %}
                <tr>
                    <td>{{ names[evaler] }}</th>
                    <td width="80px" style="word-wrap:break-word;">{{ connection[student.user_name][evaler] }}</th>
                    <td>{{ len(evals[currentWeek-1][evaler]) }}</th>
                    <td>{{ reversedEvals[currentWeek-1][student.user_name][evaler][1] }}</th>
                    <td>{{ reversedEvals[currentWeek-1][student.user_name][evaler][2] }}</th>
                    <td width="100px" style="word-wrap:break-word;">{{ reversedEvals[currentWeek-1][student.user_name][evaler][0].adjective }}</th>
                    <td width="600px" style="word-wrap:break-word;">{{ reversedEvals[currentWeek-1][student.user_name][evaler][0].description }}</th>
                </tr>
            {% endfor %}
        </table>

        {% include 'charts/' + student.user_name + '.html' %}
    {% endfor %}

  </body>
</html>